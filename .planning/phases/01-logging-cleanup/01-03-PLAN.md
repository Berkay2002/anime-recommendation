---
phase: 01-logging-cleanup
plan: 03
type: execute
wave: 1
depends_on: [01-01]
files_modified:
  - frontend/app/api/anime/jikan/[id]/route.ts
  - frontend/app/api/anime/reviews/[id]/route.ts
  - frontend/app/api/anime/route.ts
  - frontend/app/api/anime/search/route.ts
  - frontend/app/api/anime/recommendation/[id]/route.ts
  - frontend/app/api/anime/recommendation/route.ts
  - frontend/app/api/embeddings/process/route.ts
  - frontend/app/api/queue/process/route.ts
  - frontend/app/api/diagnose-schema/route.ts
  - frontend/app/page.tsx
  - frontend/app/anime/[id]/page.tsx
  - frontend/app/anime/page.tsx
  - frontend/components/SearchBar.tsx
  - frontend/hooks/useRecommendations.ts
  - frontend/hooks/useLocalStorage.ts
  - frontend/lib/animeCache.ts
  - frontend/lib/postgres.ts
autonomous: true
must_haves:
  truths:
    - "All API routes use structured logging with request context"
    - "No console.log/console.error statements in production code"
    - "Logs include request method, route, and relevant parameters"
  artifacts:
    - path: "frontend/app/api/*/route.ts"
      provides: "API routes with structured logging"
      replaces: "console.log/console.error statements"
    - path: "frontend/components/*.tsx"
      provides: "Components with clean logging"
      replaces: "console.log/console.error statements"
    - path: "frontend/hooks/*.ts"
      provides: "Hooks with structured logging"
      replaces: "console.log/console.error statements"
    - path: "frontend/lib/*.ts"
      provides: "Library files with structured logging"
      replaces: "console.log/console.error statements"
  key_links:
    - from: "API routes"
      to: "@/lib/logger"
      via: "import with request context"
      pattern: "logger\.child.*route.*method"
---

<objective>
Replace all remaining console.log/console.error statements in API routes, components, hooks, and library files with structured logging.

Purpose: Complete the logging cleanup by removing all console statements from the remaining codebase, ensuring production-ready code with proper error tracking.
Output: Clean codebase with zero console.log statements and consistent structured logging throughout.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-logging-cleanup/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace console statements in API routes</name>
  <files>
    frontend/app/api/anime/jikan/[id]/route.ts
    frontend/app/api/anime/reviews/[id]/route.ts
    frontend/app/api/anime/route.ts
    frontend/app/api/anime/search/route.ts
    frontend/app/api/anime/recommendation/[id]/route.ts
    frontend/app/api/anime/recommendation/route.ts
    frontend/app/api/embeddings/process/route.ts
    frontend/app/api/queue/process/route.ts
    frontend/app/api/diagnose-schema/route.ts
  </files>
  <action>
    For each API route file:
    - Import logger from '@/lib/logger' at the top
    - Create a child logger with route context inside each handler:
      const log = logger.child({ route: '/api/anime/search', method: 'GET' })
    - Replace all console.log with appropriate log.debug or log.info
    - Replace all console.error with log.error
    - Add request-specific context (query params, request ID, etc.)
    - Log request start at debug level, completion at info level
    - Log errors with full context including the error object

    Focus on maintaining the existing error handling while improving logging quality.
  </action>
  <verify>grep -r "console\." /Volumes/extSSD/dev/projects/anime-recommendation/frontend/app/api/ || echo "No console statements found"</verify>
  <done>Zero console.log/console.error statements in any API route files</done>
</task>

<task type="auto">
  <name>Task 2: Replace console statements in components</name>
  <files>
    frontend/app/page.tsx
    frontend/app/anime/[id]/page.tsx
    frontend/app/anime/page.tsx
    frontend/components/SearchBar.tsx
  </files>
  <action>
    For component files:
    - Import logger from '@/lib/logger' at the top
    - Replace console.log with logger calls (use debug for development info, warn for warnings)
    - Replace console.error with logger.error
    - Add component context to logs
    - Be careful with client-side components - use conditional imports or simple console methods for client-side only code
    - For Next.js app router, most components can use the logger since they're server components by default

    Note: Some components might be client components, handle appropriately.
  </action>
  <verify>grep -r "console\." /Volumes/extSSD/dev/projects/anime-recommendation/frontend/app/page.tsx /Volumes/extSSD/dev/projects/anime-recommendation/frontend/app/anime/ /Volumes/extSSD/dev/projects/anime-recommendation/frontend/components/ || echo "No console statements found"</verify>
  <done>Zero console.log/console.error statements in component files</done>
</task>

<task type="auto">
  <name>Task 3: Replace console statements in hooks and libraries</name>
  <files>
    frontend/hooks/useRecommendations.ts
    frontend/hooks/useLocalStorage.ts
    frontend/lib/animeCache.ts
    frontend/lib/postgres.ts
  </files>
  <action>
    For hooks and library files:
    - Import logger from '@/lib/logger' at the top
    - Replace console statements with appropriate logger calls
    - Add context about the operation being performed
    - For database operations, log query details at debug level
    - For cache operations, log hit/miss rates at info level
    - Maintain existing error handling logic

    Hooks might run on both server and client, handle appropriately.
  </action>
  <verify>grep -r "console\." /Volumes/extSSD/dev/projects/anime-recommendation/frontend/hooks/ /Volumes/extSSD/dev/projects/anime-recommendation/frontend/lib/ || echo "No console statements found"</verify>
  <done>Zero console.log/console.error statements in hooks and library files</done>
</task>

<task type="auto">
  <name>Task 4: Verify complete cleanup and test logging</name>
  <files>frontend/</files>
  <action>
    Perform final verification:
    - Search entire frontend directory for any remaining console.log/console.error/console.warn/console.info
    - Ignore node_modules, .next, and other build directories
    - Check that logger is imported correctly in all modified files
    - Verify that the application still builds without errors
    - Test that logs appear correctly in development mode
    - Ensure no sensitive data is being logged

    Create a simple test to verify the logger is working correctly.
  </action>
  <verify>find /Volumes/extSSD/dev/projects/anime-recommendation/frontend -name "*.ts" -o -name "*.tsx" | grep -v node_modules | grep -v .next | xargs grep -l "console\." || echo "No console statements found in TypeScript files"</verify>
  <done>Zero console statements remain in the entire frontend codebase</done>
</task>

</tasks>

<verification>
After completion:
1. Entire frontend codebase is free of console.log statements
2. All files use structured logging with proper context
3. Application builds and runs without errors
4. Logs are properly formatted in development
</verification>

<success_criteria>
- Zero console.log/console.error/console.warn/console.info statements in frontend codebase
- All TypeScript/TSX files use structured logging
- Logger imports are working correctly
- Application builds successfully
- Development logs show pretty-printed format
- Production logs would show JSON format (testable by setting NODE_ENV=production)
</success_criteria>

<output>
After completion, create `.planning/phases/01-logging-cleanup/01-03-SUMMARY.md`
</output>